<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Luca's Hitster</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      color: #222;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    .app {
      background: #ffffff;
      padding: 24px 20px 28px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      max-width: 520px;
      width: 100%;
      text-align: center;
    }

    h1 {
      font-size: 1.5rem;
      margin-bottom: 8px;
    }

    p.description {
      font-size: 0.9rem;
      color: #555;
      margin-bottom: 12px;
    }

    .preset-tabs {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 6px;
      margin-bottom: 14px;
    }

    .preset-btn {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid #ddd;
      background: #fafafa;
      font-size: 0.8rem;
      cursor: pointer;
      transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
    }

    .preset-btn.active {
      background: #4a90e2;
      color: #fff;
      border-color: #4a90e2;
    }

    .wheel-container {
      position: relative;
      margin: 0 auto 10px;
      width: 320px;
      height: 320px;
    }

    canvas#wheel {
      width: 100%;
      height: 100%;
      display: block;
    }

    .pointer {
      position: absolute;
      top: 50%;
      right: -24px;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      border-top: 16px solid transparent;
      border-bottom: 16px solid transparent;
      border-left: 28px solid #e74c3c;
    }

    .controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      margin-top: 4px;
    }

    button {
      font-family: inherit;
    }

    #spinButton {
      padding: 10px 22px;
      border-radius: 999px;
      border: none;
      background: #4a90e2;
      color: #fff;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.2s ease;
    }

    #spinButton:hover {
      background: #3b7acc;
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.18);
    }

    #spinButton:active {
      transform: translateY(1px);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    }

    #spinButton:disabled {
      background: #cccccc;
      box-shadow: none;
      cursor: default;
      transform: none;
    }

    .speed-controls {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.78rem;
      color: #555;
      flex-wrap: wrap;
      justify-content: center;
    }

    .speed-btn {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #ddd;
      background: #fafafa;
      cursor: pointer;
      font-size: 0.78rem;
    }

    .speed-btn.active {
      background: #4a90e2;
      color: #fff;
      border-color: #4a90e2;
    }

    #shuffleButton {
      padding: 6px 16px;
      border-radius: 999px;
      border: 1px solid #ddd;
      background: #ffffff;
      font-size: 0.85rem;
      cursor: pointer;
    }

    #shuffleButton:hover {
      background: #f1f1f1;
    }

    .result {
      margin-top: 8px;
      font-size: 1rem;
      font-weight: 600;
      min-height: 1.4em;
    }

    /* TIMER-STYLES */
    .timer-block {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      font-size: 0.8rem;
      color: #555;
      margin-top: 10px;
    }

    .timer-row {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .timer-btn {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #ddd;
      background: #fafafa;
      cursor: pointer;
      font-size: 0.78rem;
    }

    .timer-btn.active {
      background: #4a90e2;
      color: #fff;
      border-color: #4a90e2;
    }

    #timerDisplay {
      font-family: monospace;
      font-size: 1.1rem;
      margin-top: 4px;
    }

    .timer-finished {
      color: #e74c3c;
      font-weight: 700;
    }

    #timerStartButton {
      margin-top: 6px;
      padding: 6px 18px;
      border-radius: 999px;
      border: 1px solid #ddd;
      background: #fff;
      cursor: pointer;
      font-size: 0.85rem;
    }

    #timerStartButton:hover {
      background: #f1f1f1;
    }

    @media (max-width: 480px) {
      .app {
        margin: 12px;
        padding: 18px 14px 22px;
      }
      .wheel-container {
        width: 260px;
        height: 260px;
      }
      .pointer {
        right: -18px;
        border-top-width: 14px;
        border-bottom-width: 14px;
        border-left-width: 22px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>Luca's Hitster</h1>
    <p class="description">
      Wähle ein Rad, stell die Geschwindigkeit ein und klicke auf „Drehen“.
    </p>

    <!-- Tabs für mehrere Glücksräder -->
    <div class="preset-tabs">
      <button class="preset-btn active" data-preset="classic">Einfach</button>
      <button class="preset-btn" data-preset="party">Fortgeschritten</button>
      <button class="preset-btn" data-preset="challenges">Extrem</button>
    </div>

    <div class="wheel-container">
      <canvas id="wheel" width="500" height="500"></canvas>
      <div class="pointer"></div>
    </div>

    <div class="controls">
      <button id="spinButton">Drehen</button>

      <div class="speed-controls">
        <span>Geschwindigkeit:</span>
        <button class="speed-btn active" data-speed="normal">Normal</button>
        <button class="speed-btn" data-speed="slow">Langsam</button>
        <button class="speed-btn" data-speed="epic">Epic</button>
      </div>

      <!-- TIMER -->
      <div class="timer-block">
        <div class="timer-row">
          <span>Timer:</span>
          <button class="timer-btn active" data-time="30">30s</button>
          <button class="timer-btn" data-time="60">60s</button>
          <button class="timer-btn" data-time="90">90s</button>
        </div>

        <div id="timerDisplay">00:30</div>
        <button id="timerStartButton">Timer starten</button>
      </div>

      <button id="shuffleButton">Shuffle Kategorien</button>
    </div>

    <div class="result" id="result"></div>
  </div>

  <script>
    // ========================
    // 1. KATEGORIEN PRO RAD
    // ========================
    const presets = {
      classic: [
        "Gruppe/Solo?",
        "Vor/Nach 2000?",
        "Jahrzehnt?",
        "Video?",
        "Genre?",
        "Erscheinungsjahr +/-5",
      ],
      party: [
        "Songtitel",
        "Interpret-Name",
        "Erscheinungsjahr +/-2",
        "Debüthit?",
        "Größter Hit?",
        "Kontinent?",
        "Charts Top 10?",
      ],
      challenges: [
        "Erscheinungsjahr",
        "Alter beim Release",
        "Beruf vor Karriere",
        "Spotify Streams?",
        "Jahreszeit?",
        "Land?",
      ]
    };

    // ========================
    // 2. AUDIO: TICK + JUBEL
    // ========================
    // WICHTIG:
    // Lege in deinem GitHub-Repo zwei Dateien ab:
    //  - tick.mp3   (kurzer "tick"-Sound)
    //  - cheer.mp3  (Jubel / Applaus)
    const tickSound = new Audio("tick.mp3");
    tickSound.volume = 0.3;
    const winSound = new Audio("cheer.mp3");
    winSound.volume = 0.6;
    let tickInterval = null;

    // ========================
    // 3. GRUNDLAGEN
    // ========================
    let currentPreset = "classic";
    let categories = [...presets[currentPreset]];

    const canvas = document.getElementById("wheel");
    const ctx = canvas.getContext("2d");
    const spinButton = document.getElementById("spinButton");
    const shuffleButton = document.getElementById("shuffleButton");
    const resultDiv = document.getElementById("result");

    const presetButtons = document.querySelectorAll(".preset-btn");
    const speedButtons = document.querySelectorAll(".speed-btn");

    let numSegments = categories.length;
    let arc = (2 * Math.PI) / numSegments;

    const colors = [
      "#f1c40f",
      "#e67e22",
      "#e74c3c",
      "#9b59b6",
      "#3498db",
      "#1abc9c",
      "#2ecc71",
      "#16a085",
      "#8e44ad",
      "#34495e"
    ];

    let rotation = 0;
    let spinning = false;
    let targetRotation = 0;
    let startTime = null;

    // Geschwindigkeits-Settings
    let spinDuration = 4000; // normal
    let extraSpinsBase = 5;  // Basisanzahl Umdrehungen

    // ========================
    // TIMER VARIABLEN
    // ========================
    const timerButtons = document.querySelectorAll(".timer-btn");
    const timerDisplay = document.getElementById("timerDisplay");
    const timerStartButton = document.getElementById("timerStartButton");

    let roundDuration = 30;       // Standard: 30 Sekunden
    let timerRemaining = 30;
    let timerInterval = null;

    function formatTime(s) {
      const m = Math.floor(s / 60);
      const sec = s % 60;
      return (
        String(m).padStart(2, "0") + ":" + String(sec).padStart(2, "0")
      );
    }

    function updateTimerDisplay() {
      timerDisplay.textContent = formatTime(timerRemaining);
    }

    function resetTimer() {
      if (timerInterval) clearInterval(timerInterval);
      timerRemaining = roundDuration;
      updateTimerDisplay();
      timerDisplay.classList.remove("timer-finished");
    }

    function startTimer() {
      if (timerInterval) clearInterval(timerInterval);

      timerRemaining = roundDuration;
      updateTimerDisplay();
      timerDisplay.classList.remove("timer-finished");

      timerInterval = setInterval(() => {
        timerRemaining--;

        if (timerRemaining <= 0) {
          timerRemaining = 0;
          updateTimerDisplay();
          timerDisplay.classList.add("timer-finished");
          clearInterval(timerInterval);
        } else {
          updateTimerDisplay();
        }
      }, 1000);
    }

    function setActiveTimerButton(activeBtn) {
      timerButtons.forEach(btn => btn.classList.remove("active"));
      activeBtn.classList.add("active");
    }

    timerButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        roundDuration = parseInt(btn.dataset.time, 10);
        setActiveTimerButton(btn);
        resetTimer();
      });
    });

    timerStartButton.addEventListener("click", () => {
      startTimer();
    });

    function updateDerived() {
      numSegments = categories.length;
      arc = (2 * Math.PI) / numSegments;
    }

    function drawWheel() {
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const radius = Math.min(centerX, centerY) - 10;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      for (let i = 0; i < numSegments; i++) {
        const angleStart = i * arc + rotation;
        const angleEnd = angleStart + arc;

        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.arc(centerX, centerY, radius, angleStart, angleEnd);
        ctx.closePath();

        ctx.fillStyle = colors[i % colors.length];
        ctx.fill();

        ctx.save();
        ctx.translate(centerX, centerY);
        ctx.rotate(angleStart + arc / 2);
        ctx.textAlign = "right";
        ctx.fillStyle = "#000";
        ctx.font = "16px sans-serif";
        ctx.fillText(categories[i], radius - 12, 5);
        ctx.restore();
      }

      // Kreis in der Mitte
      ctx.beginPath();
      ctx.arc(centerX, centerY, 40, 0, 2 * Math.PI);
      ctx.fillStyle = "#ffffff";
      ctx.fill();
      ctx.lineWidth = 2;
      ctx.strokeStyle = "#333333";
      ctx.stroke();
    }

    function easeOutCubic(x) {
      return 1 - Math.pow(1 - x, 3);
    }

    function stopTickSound() {
      if (tickInterval) {
        clearInterval(tickInterval);
        tickInterval = null;
      }
    }

    function animateSpin(timestamp) {
      if (!startTime) startTime = timestamp;
      const elapsed = timestamp - startTime;
      const progress = Math.min(elapsed / spinDuration, 1);
      const eased = easeOutCubic(progress);

      rotation = eased * targetRotation;
      drawWheel();

      if (progress < 1) {
        requestAnimationFrame(animateSpin);
      } else {
        spinning = false;
        spinButton.disabled = false;
        stopTickSound();
        // Jubel-Sound am Ende
        winSound.currentTime = 0;
        winSound.play().catch(() => {});
      }
    }

    // ========================
    // 4. SPIN BUTTON
    // ========================
    spinButton.addEventListener("click", () => {
      if (spinning || numSegments === 0) return;

      spinning = true;
      spinButton.disabled = true;
      startTime = null;
      resultDiv.textContent = "Am Drehen...";

      // Gewinner vorab bestimmen
      const winningIndex = Math.floor(Math.random() * numSegments);

      const extraSpins = extraSpinsBase + Math.floor(Math.random() * 3);
      targetRotation = extraSpins * 2 * Math.PI - (winningIndex + 0.5) * arc;

      // Tick-Tick-Tick während des Spins
      stopTickSound();
      tickInterval = setInterval(() => {
        const t = tickSound.cloneNode();
        t.play().catch(() => {});
      }, 80);

      requestAnimationFrame(animateSpin);

      // Ergebnis nach SpinDuration anzeigen
      setTimeout(() => {
        resultDiv.textContent = "Ergebnis: " + categories[winningIndex];
      }, spinDuration + 150);
    });

    // ========================
    // 5. PRESET-WECHSEL
    // ========================
    function setActivePresetButton(activeBtn) {
      presetButtons.forEach(btn => btn.classList.remove("active"));
      activeBtn.classList.add("active");
    }

    presetButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        if (spinning) return;
        const presetName = btn.dataset.preset;
        currentPreset = presetName;
        categories = [...presets[currentPreset]];
        updateDerived();
        setActivePresetButton(btn);
        resultDiv.textContent = "";
        rotation = 0;
        targetRotation = 0;
        drawWheel();
      });
    });

    // ========================
    // 6. SPEED BUTTONS
    // ========================
    function setActiveSpeedButton(activeBtn) {
      speedButtons.forEach(btn => btn.classList.remove("active"));
      activeBtn.classList.add("active");
    }

    speedButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const speed = btn.dataset.speed;
        if (speed === "slow") {
          spinDuration = 2500;
          extraSpinsBase = 4;
        } else if (speed === "normal") {
          spinDuration = 4000;
          extraSpinsBase = 5;
        } else if (speed === "epic") {
          spinDuration = 7000;
          extraSpinsBase = 7;
        }
        setActiveSpeedButton(btn);
      });
    });

    // ========================
    // 7. SHUFFLE-BUTTON
    // ========================
    shuffleButton.addEventListener("click", () => {
      if (spinning) return;
      // Fisher–Yates Shuffle
      for (let i = categories.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [categories[i], categories[j]] = [categories[j], categories[i]];
      }
      updateDerived();
      drawWheel();
      resultDiv.textContent = "Kategorien gemischt.";
    });

    // Erste Zeichnung + Timer-Anzeige
    updateDerived();
    drawWheel();
    updateTimerDisplay();
  </script>
</body>
</html>


   
